let red = [
  "Absolution of Inspiring",
  "Animate Guardian of Smiting",
  "Bladestorm of Uncertainty",
  "Boneshatter of Carnage",
  "Boneshatter of Complex Trauma",
  "Cleave of Rage",
  "Consecrated Path of Endurance",
  "Dominating Blow of Inspiring",
  "Earthquake of Amplification",
  "Earthshatter of Fragility",
  "Earthshatter of Prominence",
  "Exsanguinate of Transmission",
  "Frozen Legion of Rallying",
  "Glacial Hammer of Shattering",
  "Ground Slam of Earthshaking",
  "Holy Flame Totem of Ire",
  "Ice Crash of Cadence",
  "Infernal Blow of Immolation",
  "Leap Slam of Groundbreaking",
  "Molten Strike of the Zenith",
  "Perforate of Bloodshed",
  "Perforate of Duality",
  "Rage Vortex of Berserking",
  "Shield Crush of the Chieftain",
  "Smite of Divine Judgement",
  "Summon Flame Golem of Hordes",
  "Summon Flame Golem of the Meteor",
  "Summon Stone Golem of Hordes",
  "Summon Stone Golem of Safeguarding",
  "Sunder of Earthbreaking",
  "Tectonic Slam of Cataclysm",
  "Volcanic Fissure of Snaking",
];
let green = [
  "Animate Weapon of Ranged Arms",
  "Animate Weapon of Self Reflection",
  "Artillery Ballista of Cross Strafe",
  "Artillery Ballista of Focus Fire",
  "Barrage of Volley Fire",
  "Bear Trap of Skewers",
  "Blade Blast of Dagger Detonation",
  "Blade Blast of Unloading",
  "Blade Flurry of Incision",
  "Blade Trap of Greatswords",
  "Blade Trap of Laceration",
  "Blade Vortex of the Scythe",
  "Bladefall of Impaling",
  "Bladefall of Volleys",
  "Blink Arrow of Bombarding Clones",
  "Blink Arrow of Prismatic Clones",
  "Burning Arrow of Vigour",
  "Caustic Arrow of Poison",
  "Cremation of Exhuming",
  "Cremation of the Volcano",
  "Cyclone of Tumult",
  "Detonate Dead of Chain Reaction",
  "Detonate Dead of Scavenging",
  "Double Strike of Impaling",
  "Double Strike of Momentum",
  "Dual Strike of Ambidexterity",
  "Elemental Hit of the Spectrum",
  "Ethereal Knives of Lingering Blades",
  "Ethereal Knives of the Massacre",
  "Explosive Concoction of Destruction",
  "Explosive Trap of Magnitude",
  "Explosive Trap of Shrapnel",
  "Fire Trap of Blasting",
  "Flicker Strike of Power",
  "Frenzy of Onslaught",
  "Frost Blades of Katabasis",
  "Galvanic Arrow of Energy",
  "Galvanic Arrow of Surging",
  "Ice Shot of Penetration",
  "Ice Trap of Hollowness",
  "Lacerate of Butchering",
  "Lacerate of Haemorrhage",
  "Lancing Steel of Spraying",
  "Lightning Arrow of Electrocution",
  "Lightning Strike of Arcing",
  "Mirror Arrow of Bombarding Clones",
  "Mirror Arrow of Prismatic Clones",
  "Poisonous Concoction of Bouncing",
  "Rain of Arrows of Artillery",
  "Rain of Arrows of Saturation",
  "Reave of Refraction",
  "Scourge Arrow of Menace",
  "Seismic Trap of Swells",
  "Shattering Steel of Ammunition",
  "Shrapnel Ballista of Steel",
  "Siege Ballista of Splintering",
  "Spectral Shield Throw of Shattering",
  "Spectral Throw of Materialising",
  "Split Arrow of Splitting",
  "Splitting Steel of Ammunition",
  "Storm Rain of the Conduit",
  "Storm Rain of the Fence",
  "Summon Ice Golem of Hordes",
  "Summon Ice Golem of Shattering",
  "Tornado of Elemental Turbulence",
  "Tornado Shot of Cloudburst",
  "Toxic Rain of Sporeburst",
  "Toxic Rain of Withering",
  "Viper Strike of the Mamba",
  "Volatile Dead of Confinement",
  "Volatile Dead of Seething",
  "Wild Strike of Extremes",
];
let blue = [
  "Arc of Oscillating",
  "Arc of Surging",
  "Armageddon Brand of Recall",
  "Armageddon Brand of Volatility",
  "Ball Lightning of Orbiting",
  "Ball Lightning of Static",
  "Bane of Condemnation",
  "Blight of Atrophy",
  "Blight of Contagion",
  "Bodyswap of Sacrifice",
  "Cold Snap of Power",
  "Contagion of Subsiding",
  "Contagion of Transference",
  "Crackling Lance of Branching",
  "Crackling Lance of Disintegration",
  "Discharge of Misery",
  "Divine Ire of Disintegration",
  "Divine Ire of Holy Lightning",
  "Essence Drain of Desperation",
  "Essence Drain of Wickedness",
  "Eye of Winter of Finality",
  "Eye of Winter of Transience",
  "Firestorm of Meteors",
  "Firestorm of Pelting",
  "Flame Dash of Return",
  "Flame Surge of Combusting",
  "Flameblast of Celerity",
  "Flameblast of Contraction",
  "Forbidden Rite of Soul Sacrifice",
  "Frost Bomb of Forthcoming",
  "Frost Bomb of Instability",
  "Frostblink of Wintry Blast",
  "Galvanic Field of Intensity",
  "Glacial Cascade of the Fissure",
  "Hexblast of Contradiction",
  "Hexblast of Havoc",
  "Ice Nova of Deep Freeze",
  "Ice Nova of Frostbolts",
  "Ice Spear of Splitting",
  "Icicle Mine of Fanning",
  "Icicle Mine of Sabotage",
  "Incinerate of Expanse",
  "Incinerate of Venting",
  "Kinetic Blast of Clustering",
  "Kinetic Bolt of Fragmentation",
  "Lightning Conduit of the Heavens",
  "Lightning Spire Trap of Overloading",
  "Lightning Spire Trap of Zapping",
  "Lightning Tendrils of Eccentricity",
  "Lightning Tendrils of Escalation",
  "Lightning Trap of Sparking",
  "Penance Brand of Conduction",
  "Penance Brand of Dissipation",
  "Power Siphon of the Archmage",
  "Purifying Flame of Revelations",
  "Pyroclast Mine of Sabotage",
  "Raise Spectre of Transience",
  "Raise Zombie of Falling",
  "Raise Zombie of Slamming",
  "Righteous Fire of Arcane Devotion",
  "Scorching Ray of Immolation",
  "Soulrend of Reaping",
  "Soulrend of the Spiral",
  "Spark of the Nova",
  "Spark of Unpredictability",
  "Storm Brand of Indecision",
  "Stormbind of Teleportation",
  "Summon Carrion Golem of Hordes",
  "Summon Carrion Golem of Scavenging",
  "Summon Chaos Golem of Hordes",
  "Summon Chaos Golem of the MaelstrÃ¶m",
  "Summon Holy Relic of Conviction",
  "Summon Lightning Golem of Hordes",
  "Summon Raging Spirit of Enormity",
  "Summon Reaper of Eviscerating",
  "Summon Reaper of Revenants",
  "Summon Skeletons of Archers",
  "Summon Skeletons of Mages",
  "Void Sphere of Rending",
  "Vortex of Projection",
];

let checkedGemLevel = document.querySelector(
  "#gemLevel input[type=radio]:checked",
).value;
let checkedGemQuality = document.querySelector(
  "#gemQuality input[type=radio]:checked",
).value;
let radio = document.querySelectorAll("input[type=radio]").forEach((el) => {
  el.addEventListener("change", () => {
    checkedGemLevel = document.querySelector(
      "#gemLevel input[type=radio]:checked",
    ).value;
    checkedGemQuality = document.querySelector(
      "#gemQuality input[type=radio]:checked",
    ).value;
    mainRender();
  })
})


function mainRender(){
  let redCombined = 0;
  let greenCombined = 0;
  let blueCombined = 0;

  fetch("/api/skill-gems")
    .then((response) => response.json())
    .then((data) => {
      
      data.lines.forEach((element) => {

        if (
          element.tradeFilter !== undefined &&
          element.corrupted == (checkedGemLevel > 20 || checkedGemQuality > 20 ? true : undefined) &&
          element.gemLevel == checkedGemLevel &&
          element.gemQuality == (checkedGemQuality > 0 ? checkedGemQuality : undefined)
        ) {          
          if (element.chaosValue >= 50) {
            if (red.includes(element.name)) {
              redCombined += element.chaosValue;
            } else if (green.includes(element.name)) {
              greenCombined += element.chaosValue;
            } else if (blue.includes(element.name)) {
              blueCombined += element.chaosValue;
            }
          }
        }
      });

      let redAverage = redCombined / red.length;
      let greenAverage = greenCombined / green.length;
      let blueAverage = blueCombined / blue.length;

      document.getElementById("red-result").textContent =
        `Red Gems: Average Chaos per Gem = ${redAverage.toFixed(2)}`;
      document.getElementById("green-result").textContent =
        `Green Gems: Average Chaos per Gem = ${greenAverage.toFixed(2)}`;
      document.getElementById("blue-result").textContent =
        `Blue Gems: Average Chaos per Gem = ${blueAverage.toFixed(2)}`;
    })
    .catch((error) => {
      console.error("Error fetching data:", error);
      document.getElementById("red-result").textContent = "Error fetching data.";
      document.getElementById("green-result").textContent =
        "Error fetching data.";
      document.getElementById("blue-result").textContent = "Error fetching data.";
    });
}
mainRender();

